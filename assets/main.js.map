{"version":3,"file":"main.js","sources":["../src/utilities.js","../src/state.js","../src/templates.js","../src/render.js","../src/updateResults.js","../src/bind.js","../src/index.js"],"sourcesContent":["\nexport default class utilities {\n\n    static getEnvironmentType(hostname) {\n        switch (hostname) {\n            case 'localhost':\n            {\n                return `development`;\n            }\n            case '127.0.0.1':\n            {\n                return `development`;\n            }\n            default:\n            {\n                return `production`;\n            }\n        }\n    }\n\n    static getUrlParams() {\n        const queryString = location.search;\n        if (!queryString) {\n            return {};\n        }\n\n        let queries = queryString.split(/[\\&?]+/);\n        queries.splice(0, 1);\n\n        let returnValue = {};\n        queries.forEach(query => {\n            const splitQuery = query.split('=');\n            try {\n                splitQuery[1] = decodeURIComponent(splitQuery[1]);\n            } catch(e) {\n                console.error(e);\n            }\n\n            returnValue[splitQuery[0]] = splitQuery[1];\n        });\n\n        return returnValue;\n    }\n}\n","import utilities from './utilities';\n\nlet currentState = {\n    count: 0,\n    areaCount: 0,\n    query: utilities.getUrlParams().q || ``,\n    filter: {\n        id: utilities.getUrlParams().filter || ``,\n        name: utilities.getUrlParams().filter || ``\n    },\n    apiUrl: \"https://search.discovery.onsdigital.co.uk\"\n};\n\nexport default class state {\n\n    static getState() {\n        return JSON.parse(JSON.stringify(currentState));\n    }\n\n    static updateState(action) {\n        const newState = this.getState();\n        console.log(`State update: \\n`, action);\n        switch (action.type) {\n            case ('UPDATE_COUNT'): {\n                newState.count = action.value;\n                break;\n            }\n            case ('UPDATE_AREA_COUNT'): {\n                newState.areaCount = action.value;\n                break;\n            }\n            case ('UPDATE_QUERY'): {\n                newState.query = action.value;\n                break;\n            }\n            case ('UPDATE_FILTER'): {\n                newState.filter = action.value;\n                break;\n            }\n        }\n\n        currentState = newState;\n    }\n\n}\n","import state from './state';\n\nexport default class templates {\n\n    static searchText(children) {\n        const currentState = state.getState();\n        const query = currentState.query;\n        const count = currentState.count;\n        const filter = currentState.filter.id;\n        const filterName = currentState.filter.name;\n\n        function wrapInContainer(children) {\n            return (\n                `<div class=\"border-bottom--iron-md border-bottom--iron-lg\">\n                <h2 class=\"search-text margin-top--2 margin-bottom--2\">\n                    ${children}\n                </h2>\n            </div>`\n            )\n        }\n\n        if (children) {\n            return wrapInContainer(children)\n        }\n\n        if (query && count === 0) {\n            return wrapInContainer(`No results for <strong>'${currentState.query}'</strong>`);\n        }\n\n        if (!query) {\n            return wrapInContainer(`No search query, showing all <strong>'${count}'</strong> results`);\n        }\n\n        if (query && filter) {\n            return wrapInContainer(`<strong>${count}</strong> results found for <strong>'${query}'</strong>, filter by area type <strong>'${filterName}'</strong>`)\n        }\n\n        return wrapInContainer(`<strong>${count}</strong> results found for <strong>'${query}'</strong>`);\n    }\n\n    static areaSearchText() {\n        const currentState = state.getState();\n        const query = currentState.query;\n        const count = currentState.areaCount;\n\n        function wrapInContainer(children) {\n            return (\n                `<div class=\"col\">\n                <h2 class=\"search-text margin-top--2 margin-bottom--2\">\n                    ${children}\n                </h2>\n            </div>`\n            )\n        }\n\n        return wrapInContainer(`\n        Showing the top <strong>${(count > 4) ? `4` : count}</strong> suggested location${count > 1 ? `s` : ``}${query ? ` for <strong>'${query}'</strong>` : ''}.\n        <a href=\"\">View all</a>\n    `)\n    }\n\n    static datasetResultItem(data) {\n        return (\n            `<div class=\"result border-bottom--iron-md border-bottom--iron-lg\">\n            <h3 class=\"result__title\"><a href=\"\">${data.title}</a></h3>\n            <div class=\"result__description\">${data.description}</div>\n            <span class=\"result__metadata\">${data.type}</span>\n            <span class=\"result__metadata\">Released on ${data.releaseDate}</span>\n        </div>`\n        );\n    }\n\n    static areaResultItem(data) {\n        return (\n            `<div class=\"col col--lg-half background--iron-light margin-bottom--2 padding-top--2 padding-right--1 padding-bottom--2 padding-left--1\">\n            <span class=\"baseline\">${data.type}</span>\n            <span class=\"icon icon-arrow-right--dark float-right margin-top--1\"></span>\n            <h3 class=\"flush\">\n                <a class=\"area-link\" href=\"/?q=${state.query}&filter=${data.type_id}\" data-filter=\"${data.type_id}\" data-filter-name=\"${data.type}\">\n                    ${data.title}\n                </a>\n            </h3>\n        </div>\n        `\n        );\n    }\n}\n","import state from './state';\nimport templates from './templates';\n\nconst appElem = document.getElementById('app');\nconst title = document.getElementById('title');\n\nexport default class render {\n\n    static emptyResults() {\n        while (appElem.firstChild) appElem.removeChild(appElem.firstChild);\n    }\n\n    static allResults(areaResults, datasetResults) {\n        appElem.innerHTML += (this.areaResults(areaResults) + this.datasetResults(datasetResults));\n    }\n\n    static allResultsForAreaType(resultsData) {\n        const HTMLParts = [];\n        const currentState = state.getState();\n        const searchText = `All <strong>'${currentState.count}'</strong> results, filtered by area type <strong>'${currentState.filter.name}'</strong>`;\n\n        function wrapInContainer(children) {\n            return (\n                `<div class=\"col margin-bottom--3\">\n                ${templates.searchText(searchText)}\n                ${children}\n            </div>`\n            );\n        }\n\n        resultsData.map(result => {\n            let date = result.body.metadata.release_date.split('+');\n\n            // Check for invalid date\n            if (date[1]) {\n                date.pop();\n                date.push('Z');\n                date = date.join('');\n            }\n\n            const data = {\n                title: result.body.title,\n                description: result.body.metadata.description,\n                type: result.type,\n                releaseDate: new Date(date).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' })\n            };\n\n            HTMLParts.push(templates.datasetResultItem(data));\n        });\n\n        appElem.innerHTML += wrapInContainer(HTMLParts.join(''));\n    }\n\n    static datasetResults(resultsData) {\n        const HTMLParts = [];\n        const count = state.getState().count;\n\n        if (count === 0) {\n            return wrapInContainer(``);\n        }\n\n        function wrapInContainer(children) {\n            return (\n                `<div class=\"col margin-bottom--3\">\n                ${templates.searchText()}\n                ${children}\n            </div>`\n            );\n        }\n\n        resultsData.map(result => {\n            let date = result.body.metadata.release_date.split('+');\n\n            // Check for invalid date\n            if (date[1]) {\n                date.pop();\n                date.push('Z');\n                date = date.join('');\n            }\n\n            const data = {\n                title: result.body.title,\n                description: result.body.metadata.description,\n                type: result.type,\n                releaseDate: new Date(date).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' })\n            };\n\n            HTMLParts.push(templates.datasetResultItem(data));\n        });\n\n        return wrapInContainer(HTMLParts.join(''));\n    }\n\n    static areaResults(resultsData) {\n        const HTMLParts = [];\n        const currentState = state.getState();\n        const count = currentState.areaCount;\n        const query = currentState.query;\n\n        if (count === 0 || !query) {\n            return ``;\n        }\n\n        function wrapInContainer(children) {\n            return (\n                `<div style=\"width: 100%;\" class=\"float-left border-bottom--iron-md border-bottom--iron-lg padding-bottom--2\">\n                ${templates.areaSearchText()}\n                ${children}\n            </div>`\n            )\n        }\n\n        resultsData.some((result, index) => {\n            const data = {\n                title: result.body.title,\n                type: result.body.type,\n                type_id: result.body.type_id\n            };\n\n            HTMLParts.push(templates.areaResultItem(data));\n\n            return index === 3;\n        });\n\n        return wrapInContainer(HTMLParts.join(''));\n    }\n\n    static error() {\n        appElem.innerHTML += `\n            <div class=\"col\">\n                <h2>Oops, there's been an error</h2>\n                <p class=\"margin-top--2 margin-bottom--0\">There was an issue getting your results.</p>\n                <p class=\"flush\">Please try again in a few moments.</p>\n            </div>\n        `\n    }\n\n    static title(query) {\n        if (query) {\n            title.innerHTML = query + ` - Search - Office for National Statistics`;\n        } else {\n            title.innerHTML = `Search - Office for National Statistics`;\n        }\n    }\n}\n","import render from './render';\nimport state from './state';\nimport bind from './bind';\n\nconst inputElem = document.getElementById('search__input');\n\nexport default function updateResults() {\n\n    const currentState = state.getState();\n\n    // Fetch polyfill\n    if (!window.fetch) {\n        console.log('Using Fetch API polyfill');\n        const js = document.createElement('script');\n        js.src = 'https://cdnjs.cloudflare.com/ajax/libs/fetch/2.0.2/fetch.min.js';\n        js.onload = function() {\n            updateResults();\n        };\n        js.onerror = function() {\n            console.log('Error getting fetch API polyfill');\n        };\n        document.head.appendChild(js);\n        return;\n    }\n\n    if (currentState.query !== inputElem.value) {\n        console.log('Fetching results for \"%s\"', currentState.query);\n        inputElem.value = currentState.query;\n    }\n\n    render.title(currentState.query);\n\n    fetch(currentState.apiUrl + `/search?q=` + currentState.query + '&filter=' + currentState.filter.id).then(response => response.json()).then(response => {\n        state.updateState({\n            type: 'UPDATE_COUNT',\n            value: response.total_results\n        });\n        state.updateState({\n            type: 'UPDATE_AREA_COUNT',\n            value: response.area_results ? response.area_results.length : 0\n        });\n\n        render.emptyResults();\n\n        if (state.getState().filter.id && state.getState().count === 0) {\n            console.log(`Display all results for ${state.getState().filter.name}`);\n            fetch(`${state.getState().apiUrl}/search?filter=${state.getState().filter.id}`).then(response => response.json()).then(response => {\n                state.updateState({\n                    type: 'UPDATE_COUNT',\n                    value: response.total_results\n                });\n                state.updateState({\n                    type: 'UPDATE_AREA_COUNT',\n                    value: response.area_results ? response.area_results.length : 0\n                });\n                render.allResultsForAreaType(response.results);\n                bind.areaClick();\n            });\n            return false;\n        }\n\n        render.allResults(response.area_results, response.results);\n        bind.areaClick();\n    }).catch(error => {\n        console.log(`Error getting results data \\n`, error);\n        render.emptyResults();\n        render.error();\n    });\n}\n","import state from './state';\nimport updateResults from './updateResults';\n\nconst inputElem = document.getElementById('search__input');\nconst searchElem = document.getElementById('search');\n\nexport default class bind {\n\n    static areaClick() {\n\n        const areaLinks = document.querySelectorAll('.area-link');\n\n        areaLinks.forEach(link => {\n            link.addEventListener('click', event => {\n                handleClick(event);\n            });\n        });\n\n        function handleClick(event) {\n            event.preventDefault();\n            state.updateState({\n                type: 'UPDATE_FILTER',\n                value: {\n                    id: event.target.getAttribute('data-filter'),\n                    name: event.target.getAttribute('data-filter-name')\n                }\n            });\n            const currentState = state.getState();\n            window.history.pushState({query: currentState.query, filter: currentState.filter.id}, ``, `?q=${currentState.query}&filter=${currentState.filter.id}`);\n            updateResults();\n        }\n    }\n\n    static searchSubmit() {\n\n        searchElem.addEventListener('submit', event => {\n            const query = inputElem.value;\n            event.preventDefault();\n            state.updateState({\n                type: 'UPDATE_QUERY',\n                value: query\n            });\n            state.updateState({\n                type: 'UPDATE_FILTER',\n                value: {id: \"\", name: \"\"}\n            });\n\n            if (!query) {\n                window.history.pushState({query: query}, ``, location.pathname);\n                updateResults();\n                return;\n            }\n\n            window.history.pushState({query: query}, ``, `?q=${query}`);\n            updateResults();\n        });\n    }\n\n    static searchChange() {\n\n        inputElem.addEventListener('input', event => {\n            const inputValue = inputElem.value;\n            fetch(`https://search.discovery.onsdigital.co.uk/suggest?q=${inputValue}`).then(response => response.json()).then(response => {\n                console.log({inputValue, response});\n            });\n        })\n    }\n\n    static historyState() {\n        window.onpopstate = event => {\n            state.updateState({\n                type: 'UPDATE_QUERY',\n                value: event.state ? event.state.query : ``\n            });\n            updateResults();\n        }\n    }\n}\n","/* Imports */\nimport bind from './bind';\nimport updateResults from './updateResults';\n\n/* Initialise application */\nfunction init() {\n    updateResults();\n    bind.searchChange();\n    bind.searchSubmit();\n    bind.historyState();\n}\n\ninit();\n"],"names":["utilities","hostname","queryString","location","search","queries","split","splice","returnValue","forEach","splitQuery","query","decodeURIComponent","e","error","currentState","getUrlParams","q","filter","state","JSON","parse","stringify","action","newState","getState","log","type","count","value","areaCount","templates","children","id","filterName","name","wrapInContainer","data","title","description","releaseDate","type_id","appElem","document","getElementById","render","firstChild","removeChild","areaResults","datasetResults","innerHTML","resultsData","HTMLParts","searchText","map","date","result","body","metadata","release_date","pop","push","join","Date","toLocaleDateString","day","month","year","datasetResultItem","areaSearchText","some","index","areaResultItem","inputElem","updateResults","window","fetch","js","createElement","src","onload","onerror","head","appendChild","apiUrl","then","response","json","updateState","total_results","area_results","length","emptyResults","allResultsForAreaType","results","areaClick","allResults","catch","searchElem","bind","areaLinks","querySelectorAll","addEventListener","event","handleClick","preventDefault","target","getAttribute","history","pushState","pathname","inputValue","onpopstate","init","searchChange","searchSubmit","historyState"],"mappings":"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"}